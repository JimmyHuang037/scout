<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teachers Management</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #4CAF50;
            color: white;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 0 5px;
        }
        button:hover {
            background-color: #45a049;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        .message {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .connection-info {
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .loading {
            text-align: center;
            padding: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Teachers Management System</h1>
        
        <div class="connection-info">
            <h3>数据库连接信息</h3>
            <p><strong>Host:</strong> localhost</p>
            <p><strong>User:</strong> root</p>
            <p><strong>Password:</strong> Newuser1</p>
            <p><strong>Database:</strong> school_management</p>
            <p><strong>Table:</strong> Teachers</p>
        </div>
        
        <div class="controls">
            <button onclick="loadTeachersData()">加载教师数据</button>
            <button onclick="clearData()">清空数据</button>
        </div>
        
        <div id="message"></div>
        
        <table id="teachersTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>姓名</th>
                    <th>邮箱</th>
                    <th>科目</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td colspan="4" style="text-align: center;">点击"加载教师数据"按钮获取数据</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        // 显示消息
        function showMessage(text, isError = false) {
            const messageEl = document.getElementById('message');
            messageEl.textContent = text;
            messageEl.className = 'message ' + (isError ? 'error' : 'success');
        }

        // 显示加载状态
        function showLoading() {
            const tableBody = document.querySelector('#teachersTable tbody');
            tableBody.innerHTML = '<tr><td colspan="4" class="loading">正在加载数据...</td></tr>';
        }

        // 清空数据
        function clearData() {
            const tableBody = document.querySelector('#teachersTable tbody');
            tableBody.innerHTML = '<tr><td colspan="4" style="text-align: center;">点击"加载教师数据"按钮获取数据</td></tr>';
            document.getElementById('message').className = '';
            document.getElementById('message').textContent = '';
        }

        // 从API获取教师数据
        async function loadTeachersData() {
            try {
                showLoading();
                showMessage('正在从数据库获取数据...', false);
                
                const response = await fetch('/api/teachers');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const teachers = await response.json();
                console.log('Received data:', teachers); // 调试信息
                displayTeachersData(teachers);
                showMessage(`成功从Teachers表加载 ${teachers.length} 条记录`, false);
            } catch (error) {
                console.error('获取数据时出错:', error);
                showMessage(`获取数据失败: ${error.message}`, true);
                document.querySelector('#teachersTable tbody').innerHTML = 
                    '<tr><td colspan="4" style="text-align: center; color: red;">数据加载失败</td></tr>';
            }
        }

        // 显示教师数据
        function displayTeachersData(teachers) {
            const tableBody = document.querySelector('#teachersTable tbody');
            tableBody.innerHTML = '';
            
            if (!Array.isArray(teachers) || teachers.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="4" style="text-align: center;">暂无数据</td>';
                tableBody.appendChild(row);
                return;
            }
            
            teachers.forEach(teacher => {
                const row = document.createElement('tr');
                // 更加灵活地处理字段，适应不同的数据库列名
                const id = teacher.id || teacher.ID || teacher.Id || '';
                const name = teacher.name || teacher.Name || teacher.teacher_name || '';
                const email = teacher.email || teacher.Email || teacher.teacher_email || '';
                const subject = teacher.subject || teacher.Subject || teacher.teacher_subject || '';
                
                row.innerHTML = `
                    <td>${id}</td>
                    <td>${name}</td>
                    <td>${email}</td>
                    <td>${subject}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            showMessage('欢迎使用教师管理系统! 点击"加载教师数据"按钮从数据库获取真实数据', false);
        });
    </script>
</body>
</html>